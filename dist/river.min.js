var _$river={sandbox:function(){var e={};return{create:function(t,n){t=t.toLowerCase(),e[t]=n},run:function(t){var n={need:function(t){return t=t.toLowerCase(),e[t]&&e[t].call(n)||void 0}};t.call(n)}}}};_$river.module=_$river.sandbox();var define=_$river.module.create,main=_$river.module.run;define("river.engine",function(){function e(e){return i.need("river.grammer."+e)}function t(t,r){var o={hasRepeat:!1,context:r},i={scope:{},node:t,eom:{},reg:c};return t.attributes&&t.attributes.length&&a.loop(t.attributes,function(l){var s=l.nodeName,u=l.nodeValue.replace(c,""),f=e(s);"repeat"===s&&(o.hasRepeat=!0),"scope"===s?(o.context=i,f.call(o.context,u,o.context.scope,o.context.node),r&&a.inherit(o.context.scope,r.scope)):a.isFunction(f)&&(o.context?(o.context.node=t,f.call(o.context,u,o.context.scope,o.context.node),n(l,o.context)):(o.context=i,e("scope").call(o.context,u),f.call(o.context,u,o.context.scope,o.context.node)))}),o}function n(e,t){if(c.test(e.nodeValue)){var n=e.nodeValue.replace(/\r|\n/g,"").replace(c,"");t.eom[n]||(t.eom[n]=[]),t.eom[n].push({element:e,expression:e.nodeValue}),e.nodeValue=e.nodeValue.replace(/\r|\n/g,"").replace(/{{.*}}/,t.scope[n])}}function r(e,t){if(e.childNodes&&e.childNodes.length)for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n],i=t?t.context:void 0,a=o(r,i);if(a.hasRepeat)break}}function o(e,o){var i=t(e,o);return i.context&&n(e,i.context),"CODE"===e.nodeName||"PRE"===e.nodeName||i.hasRepeat||(i.context?r(e,i):r(e)),i}var i=this,a=i.need("river.core.tools"),c=/.*{{\s*|\s*}}.*/g;return{scan:o}}),main(function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var t=e.need("river.engine").scan;t(document)})}),define("river.scenario",function(){function e(e,t){var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}this.need("river.core.tools");return{trigger:e}}),define("river.core.Date",function(){function e(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}var t=function(t){var n=new Date,r=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours()+parseInt(t),n.getUTCMinutes(),n.getUTCSeconds());return{date:r,toString:function(t){return r.toString=e,r.toString(t)}}};return{getDateByCity:t}}),define("river.core.model",function(){function e(r,o,i,a){var c=this;if(d(r)||p(r))i&&i[o]?v(i[o],function(e){e.element.nodeValue=e.expression.replace(/{{.*}}/,r)}):i&&!i[o]&&h(i,function(e){v(e,function(e){e.element.nodeValue=e.expression.replace(/{{.*}}/,r)})});else if(u(r)){a=a?a:[];var l=t(i[o]),s=l.ele.parent.children,g=r.length-s.length,m=Math.abs(g),x=g>0,y=0>g;if(x)for(var b=r.slice(r.length-m,r.length),N=0;m>N;N++)n.call(c,i[o],l.eom,l.ele,b[N]);else if(y){Array.prototype.splice.call(i[o],0,m);for(var V=0;m>V;V++)s[V].parentNode.removeChild(s[V])}v(r,function(t,n){e.call(c,t,n,i[o][n],a[n])})}else f(r)&&(a=a?a:{},h(r,function(t,n){e.call(c,t,n,i,a[n])}))}function t(e){var t,n=a.clone(e[0]);return h(n,function(e){t||v(e,function(e){t||(t=e)})}),{eom:n,ele:t}}function n(e,t,n,o){e.push(t);var i=n.repeat.cloneNode(!0);n.parent.appendChild(i),n.element=r.call(this,i,o)[0]}function r(e,t,n){n=n||[];var i=this;return e.attributes&&o(e,i,t),e.childNodes&&e.childNodes.length?v(e.childNodes,function(e){r.call(i,e,t,n)}):n.push(e),n}function o(e,t,n){for(var r=e.attributes,o=0;o<r.length;o++){var i=r[o],a=s.need("river.grammer."+i.nodeName);a&&a.call({scope:t,node:e},i.nodeValue,t,e,n)}}function i(e,t){c[e]=t,l[e]={},this.$$ns=e}var a=this.need("river.core.tools"),c={},l={},s=this,u=a.isArray,f=a.isObject,d=a.isString,p=a.isNumber,h=a.each,v=a.loop;return i.prototype.apply=function(){var t=c[this.$$ns],n=l[this.$$ns],r=this;h(this,function(o,i){t[i]&&!a.expect(n[i]).toEqual(o)&&(e.call(r,o,i,t,n[i]),n[i]=a.clone(o))})},i.prototype.watch=function(){},i.prototype.inject=function(e){var t=this;h(e,function(n,r){t[r]=e[r]})},i}),define("river.core.tools",function(){function e(e,t){var n=function(){for(var t in e)e.hasOwnProperty&&e.hasOwnProperty(t)?this[t]=e[t]:n.prototype[t]=e[t]};for(var r in t)n.prototype[r]=t[r];var o=new n;for(var i in o)e[i]=o[i];return e}function t(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]}function n(){for(var e="$$",t=1;8>=t;t++){var n=Math.floor(16*Math.random()).toString(16);e+=n,(3==t||5==t)&&(e+="-")}return e}function r(e,t){for(var n={},r=0;r<e.length;r++)t.call(n,e[r],r)}function o(e,t){var n={};for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&t.call(n,e[r],r)}function i(e,t){return window.Object.prototype.toString.call(t)==="[object "+e+"]"}function a(e,t){if("object"!=typeof e)return e;t=t?t:i("Object",e)?{}:[];for(var n in e){var r=i("Object",e[n]),o=i("Array",e[n]),c=r||o;c?(t[n]=r?{}:[],a(e[n],t[n])):t[n]=e[n]}return t}function c(e,t){this._diffFlag=!0;for(var n in t){var r=i("Object",t[n])||i("Array",t[n]);if(r&&e)c.call(this,e[n],t[n]);else{if(!e)return void(this._diffFlag=!1);e[n]!=t[n]&&(this._diffFlag=!1)}}return this._diffFlag}function l(e){function t(t){return n?e==t:r?c.call({},t,e)&&c.call({},e,t):void 0}var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e,r="function"!=typeof e;return{toEqual:t}}var s=(Object.prototype.toString,{inherit:e,compile:t,guid:n,loop:r,each:o,clone:a,expect:l,isArray:function(e){return i("Array",e)},isObject:function(e){return i("Object",e)},isFunction:function(e){return i("Function",e)},isString:function(e){return i("String",e)},isNumber:function(e){return i("Number",e)}});return s}),define("river.grammer.jbind",function(){function e(e){function t(t){t!==o&&(r[e]=t,o=t,r.apply())}var n,r=this.scope,o=this.node.value=r[e];this.node.onfocus=function(){var e=this;n=setInterval(function(){t(e.value)},30)},this.node.onblur=function(){clearInterval(n)}}return e}),define("river.grammer.jChange",function(){function e(e){var t=this.scope[e],n=this.scope;this.node.onchange=function(){t.call({},this.value),n.apply()}}return e}),define("river.grammer.jclick",function(){function e(e,t,n,r){var o=e.replace(/\(.*\)/,""),i=t[o],a=/\((.*)\)/,c=e.match(a),l=[];c&&c.length&&(l=c[1].split(","));this.eom;n.onclick=function(){i.apply({},[r]),t.apply()}}return e}),define("river.grammer.jcompile",function(){return function(){{var e=this.node,t=(this.scope,this.reg);e.textContent.replace(t,"")}}}),define("river.grammer.repeat",function(){function e(e){return c.need("river.grammer."+e)}function t(e){var t=/.*in\s/,a=/\sin.*/,c=/.*\./,l=e.replace(t,"").replace(c,""),s=this.scope[l],u=e.replace(a,""),f=this.node.parentNode,d=f.removeChild(this.node),p=document.createDocumentFragment(),h=this.reg,v=this.eom[l]=[];i=this.scope,d.removeAttribute("repeat"),r=d,o=f,s&&s.length&&(s.forEach(function(e,t){var r=d.cloneNode(!0),o={};n(h,r,e,u,o,t),v.push(o),p.appendChild(r)}),f.appendChild(p))}function n(c,s,u,f,d){var p=!1;if(s.attributes&&s.attributes.length&&Array.prototype.forEach.call(s.attributes,function(n){if(c.test(n.nodeValue)){var h=n.nodeValue.replace(c,"").replace(f+".","");d[h]||(d[h]=[]),d[h].push({element:n,expression:n.nodeValue,repeat:r,parent:o}),n.nodeValue=n.nodeValue.replace(/{{.*}}/,u[h])}if(l.node=s,l.scope=u,l.reg=c,l.eom=d,"repeat"===n.nodeName)p=!0,t.call(l,n.nodeValue.replace(c,""));else{var v=e(n.nodeName);a.isFunction(v)&&v.call(l,n.nodeValue.replace(c,""),i,l.node,u)}}),c.test(s.nodeValue)){var h=s.nodeValue.replace(c,"").replace(f+".","");d[h]||(d[h]=[]),d[h].push({element:s,expression:s.nodeValue,repeat:r,parent:o});var v=a.isObject(u)?u[h]:u;s.nodeValue=s.nodeValue.replace(/{{.*}}/,v)}s.childNodes&&s.childNodes.length&&!p&&Array.prototype.forEach.call(s.childNodes,function(e){n(c,e,u,f,d,u)})}var r,o,i,a=this.need("river.core.tools"),c=(this.need("river.engine").scan,this),l={};return t}),define("river.grammer.scope",function(){function e(e){var o=t.need(e);if(r.isObject(o))this.scope=o;else if(r.isFunction(o)){var i=new n(e,this.eom);this.scope=i,o.call(i)}else{var a=r.guid();this.scope=new n(a,this.eom)}}var t=this,n=t.need("river.core.model"),r=t.need("river.core.tools");return e});
//# sourceMappingURL=river.map
/*! river 08-01-2014 */
var _$river={sandbox:function(){var a={};return{create:function(b,c){b=b.toLowerCase(),a[b]=c},run:function(b){var c={need:function(b){return b=b.toLowerCase(),a[b]&&a[b].call(c)||void 0}};b.call(c)}}}};_$river.module=_$river.sandbox();var define=_$river.module.create,main=_$river.module.run;define("river.core.Date",function(){function a(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a}var b=function(b){var c=new Date,d=new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours()+parseInt(b),c.getUTCMinutes(),c.getUTCSeconds());return{date:d,toString:function(b){return d.toString=a,d.toString(b)}}};return{getDateByCity:b}}),define("river.core.model",function(){function a(b,c,d){h(b)||i(b)?k(d[c],function(a){a.element.nodeValue=a.expression.replace(/{{.*}}/,b)}):f(b)?k(b,function(b,e){a(b,e,d[c][e])}):g(b)&&j(b,function(b,c){a(b,c,d)})}function b(a,b,c){d[a]=b,e[a]={},this.$$ns=a;for(var f in c)this[f]=c[f],last[f]=c[f]}var c=this.need("river.core.tools"),d={},e={},f=c.isArray,g=c.isObject,h=c.isString,i=c.isNumber,j=c.each,k=c.loop;return b.prototype.apply=function(){var b=d[this.$$ns],c=e[this.$$ns];j(this,function(d,e){b[e]&&c[e]!==d&&(a(d,e,b),c[e]=d)})},b.prototype.watch=function(){},b.prototype.inject=function(a){var b=this;j(a,function(c,d){b[d]=a[d]})},b}),define("river.core.tools",function(){var a=Object.prototype.toString,b={inherit:function(a,b){var c=function(){for(var b in a)a.hasOwnProperty&&a.hasOwnProperty(b)?this[b]=a[b]:c.prototype[b]=a[b]};for(var d in b)c.prototype[d]=b[d];var e=new c;for(var f in e)a[f]=e[f];return a},compile:function(a){var b=document.createElement("div");return b.innerHTML=a,b.childNodes[0]},guid:function(){for(var a="$$",b=1;8>=b;b++){var c=Math.floor(16*Math.random()).toString(16);a+=c,(3==b||5==b)&&(a+="-")}return a},loop:function(a,b){for(var c={},d=0;d<a.length;d++)b.call(c,a[d],d)},each:function(a,b){var c={};for(var d in a)a.hasOwnProperty&&a.hasOwnProperty(d)&&b.call(c,a[d],d)},log:function(){console&&Function.apply.call(console.log,console,arguments)},isArray:function(b){return"[object Array]"===a.apply(b)},isObject:function(a){return null!==a&&"object"==typeof a},isFunction:function(a){return"function"==typeof a},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a}};return b}),define("river.engine",function(){function a(a){return f.need("river.grammer."+a)}function b(b,d){var e={hasRepeat:!1,context:d},f={scope:{},node:b,eom:{},reg:h};return b.attributes&&b.attributes.length&&g.loop(b.attributes,function(i){var j=i.nodeName,k=i.nodeValue.replace(h,""),l=a(j);"repeat"===j&&(e.hasRepeat=!0),"scope"===j?(e.context=f,l.call(e.context,k),d&&g.inherit(e.context.scope,d.scope)):g.isFunction(l)&&(e.context?(e.context.node=b,l.call(e.context,k),c(i,e.context)):(e.context=f,a("scope").call(e.context,k),l.call(e.context,k)))}),e}function c(a,b){if(h.test(a.nodeValue)){var c=a.nodeValue.replace(/\r|\n/g,"").replace(h,"");b.eom[c]||(b.eom[c]=[]),b.eom[c].push({element:a,expression:a.nodeValue}),a.nodeValue=a.nodeValue.replace(/\r|\n/g,"").replace(/{{.*}}/,b.scope[c])}}function d(a,b){a.childNodes&&a.childNodes.length&&g.loop(a.childNodes,function(a){e(a,b)})}function e(a,e){var f=b(a,e);f.context&&c(a,f.context),"CODE"===a.nodeName||"PRE"===a.nodeName||f.hasRepeat||(f.context?d(a,f.context):d(a))}var f=this,g=f.need("river.core.tools"),h=/.*{{\s*|\s*}}.*/g;return{scan:e}}),main(function(){var a=this;document.addEventListener("DOMContentLoaded",function(){var b=a.need("river.engine").scan;b(document)})}),define("river.grammer.jbind",function(){function a(a){function b(b){b!==e&&(d[a]=b,e=b,d.apply())}var c,d=this.scope,e=this.node.value=d[a];this.node.onfocus=function(){var a=this;c=setInterval(function(){b(a.value)},30)},this.node.onblur=function(){clearInterval(c)}}return a}),define("river.grammer.jChange",function(){function a(a){var b=this.scope[a],c=this.scope;this.node.onchange=function(){b.call({},this.value),c.apply()}}return a}),define("river.grammer.jclick",function(){function a(a){var b=a.replace(/\(.*\)/,""),c=this.scope[b],d=this.scope,e=/\((.*)\)/,f=a.match(e),g=[];f&&f.length&&(g=f[1].split(",")),this.node.onclick=function(){c.apply({},g),d.apply()}}return a}),define("river.grammer.jcompile",function(){return function(){{var a=this.node,b=(this.scope,this.reg);a.textContent.replace(b,"")}}}),define("river.grammer.repeat",function(){function a(a){var c=/.*in\s/,d=/\sin.*/,e=/.*\./,f=a.replace(c,"").replace(e,""),g=this.scope[f],h=a.replace(d,""),i=this.node.parentNode,j=i.removeChild(this.node),k=document.createDocumentFragment(),l=this.reg,m=this.eom[f]=[];j.removeAttribute("repeat"),g&&g.length&&(g.forEach(function(a){var c=j.cloneNode(!0),d={};b(l,c,a,h,d),m.push(d),k.appendChild(c)}),i.appendChild(k))}function b(e,f,g,h,i){var j=!1;if(f.attributes&&f.attributes.length&&Array.prototype.forEach.call(f.attributes,function(b){if(e.test(b.nodeValue)){var c=b.nodeValue.replace(e,"").replace(h+".","");i[c]||(i[c]=[]),i[c].push({element:b,expression:b.nodeValue}),b.nodeValue=b.nodeValue.replace(/{{.*}}/,g[c])}"repeat"===b.nodeName&&(j=!0,d.node=f,d.scope=g,d.reg=e,d.eom=i,a.call(d,b.nodeValue.replace(e,"")))}),e.test(f.nodeValue)){var k=f.nodeValue.replace(e,"").replace(h+".","");i[k]||(i[k]=[]),i[k].push({element:f,expression:f.nodeValue});var l=c.isObject(g)?g[k]:g;f.nodeValue=f.nodeValue.replace(/{{.*}}/,l)}f.childNodes&&f.childNodes.length&&!j&&Array.prototype.forEach.call(f.childNodes,function(a){b(e,a,g,h,i)})}var c=this.need("river.core.tools"),d={};return a}),define("river.grammer.scope",function(){function a(a){var e=b.need(a);if(d.isObject(e))this.scope=e;else if(d.isFunction(e)){var f=new c(a,this.eom);this.scope=f,e.call(f)}else{var g=d.guid();this.scope=new c(g,this.eom)}}var b=this,c=b.need("river.core.model"),d=b.need("river.core.tools");return a}),define("river.scenario",function(){function a(a,b){var c=document.createEvent("MouseEvents");c.initEvent(a,!0,!0),b.dispatchEvent(c)}this.need("river.core.tools");return{trigger:a}});
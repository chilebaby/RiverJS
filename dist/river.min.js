var _$river={sandbox:function(){var e={};return{create:function(t,n){t=t.toLowerCase(),e[t]=n},run:function(t){var n={need:function(t){t=t.toLowerCase();var r=Object.create(n);r.exports={};var o=e[t]&&e[t].call(r,r.exports,r.need,r)||void 0;return o="function"==typeof r.exports?r.exports:Object.keys(r.exports).length?r.exports:o},exports:{}};t.call(n,n.exports,n.need,n)}}}};_$river.module=_$river.sandbox(),Object.create=Object.create||function(e){var t=function(){};return t.prototype=e,new t};var define=_$river.module.create,main=_$river.module.run;define("river.engine",function(){function e(e){return i.need("river.grammer."+e)}function t(t,r){var o={hasRepeat:!1,context:r},i={scope:{},node:t,eom:{},reg:c};return t.attributes&&t.attributes.length&&a.loop(t.attributes,function(l){var s=l.nodeName,u=l.nodeValue.replace(c,""),p=e(s);"repeat"===s&&(o.hasRepeat=!0),"scope"===s?(o.context=i,p.call(o.context,u,o.context.scope,o.context.node),r&&a.inherit(o.context.scope,r.scope)):a.isFunction(p)&&(o.context?(o.context.node=t,p.call(o.context,u,o.context.scope,o.context.node),n(l,o.context)):(o.context=i,e("scope").call(o.context,u),p.call(o.context,u,o.context.scope,o.context.node)))}),o}function n(e,t){if(c.test(e.nodeValue)){var n=e.nodeValue.replace(/\r|\n/g,"").replace(c,"");t.eom[n]||(t.eom[n]=[]),t.eom[n].push({element:e,expression:e.nodeValue});for(var r=n.split("."),o={},i=0;i<r.length;i++)"object"==typeof o&&(o=o[r[i]]||t.scope[r[i]]);o="object"==typeof o?JSON.stringify(o):o,e.nodeValue=e.nodeValue.replace(/\r|\n/g,"").replace(/{{.*}}/,o)}}function r(e,t){if(e.childNodes&&e.childNodes.length)for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n],i=t?t.context:void 0,a=o(r,i);if(a.hasRepeat)break}}function o(e,o){var i=t(e,o);return i.context&&n(e,i.context),"CODE"===e.nodeName||"PRE"===e.nodeName||i.hasRepeat||(i.context?r(e,i):r(e)),i}var i=this,a=i.need("river.core.tools"),c=/.*{{\s*|\s*}}.*/g;return{scan:o}}),main(function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var t=e.need("river.engine").scan;t(document)})}),define("river.scenario",function(){function e(e,t){var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function t(e,t,n,r){var o=document.createEvent("Events");o.initEvent(e,!0,!0),o.view=null,o.altKey=!1,o.ctrlKey=!1,o.shiftKey=!1,o.metaKey=!1,o.keyCode=t,o.charCode=n,r.dispatchEvent(o)}this.need("river.core.tools");return{trigger:e,key:t}}),define("river.core.Date",function(){function e(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}var t=function(t){var n=new Date,r=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours()+parseInt(t),n.getUTCMinutes(),n.getUTCSeconds());return{date:r,toString:function(t){return r.toString=e,r.toString(t)}}};return{getDateByCity:t}}),define("river.core.model",function(){function e(n,r,o,p){var f=this;c(n)||l(n)?o&&o[r]&&u(o[r],function(e){e.element.nodeValue=e.expression.replace(/{{.*}}/,n),"INPUT"==e.element.nodeName&&(e.element.value=e.expression.replace(/{{.*}}/,n))}):i(n)?(p=p?p:[],n.length==p.length?u(n,function(t,n){e.call(f,t,n,o,p[n])}):t(n,p,o[r])):a(n)&&(p=p?p:{},s(n,function(t,n){e.call(f,t,n,o,p[n])}))}function t(e,t,r){for(var i=e.length>t.length?e.length:t.length,a=o.expect,c=r.repeatContainer,l=0,s=0;i>s;s++){var u=e[s],p="undefined"!=typeof u;if(p&&!a(u).toEqual(t[s])){var f=n(r,u),d=c.children[s];t.splice(s,1,u),r.splice(s,1,f),c.insertBefore(f.repeat,d),d&&c.removeChild(d)}else p||(t.splice(s-l,1),r.splice(s-l,1),c.removeChild(c.children[s-l]),l++)}}function n(e,t){var n=e.trans,r=e.repeatNode,o=e.reg,i=e.key,a=r.cloneNode(!0),c={},l=[];return n(o,a,t,i,c,l),c.grammars=l,c.repeat=a,c}function r(e){if("object"==typeof e)for(var t in e)this[t]=e}var o=this.need("river.core.tools"),i=o.isArray,a=o.isObject,c=o.isString,l=o.isNumber,s=o.each,u=o.loop;return r.prototype.apply=function(){var t=this.__eom__,n=this.__last__,r=this;s(this,function(i,a){t[a]&&!o.expect(n[a]).toEqual(i)&&(e.call(r,i,a,t,n[a]),n[a]=o.clone(i))})},r.prototype.watch=function(){},r.prototype.inject=function(e){var t=this;s(e,function(n,r){t[r]=e[r]})},r}),define("river.core.tools",function(){function e(e,t){var n=function(){for(var t in e)e.hasOwnProperty&&e.hasOwnProperty(t)?this[t]=e[t]:n.prototype[t]=e[t]};for(var r in t)n.prototype[r]=t[r];var o=new n;for(var i in o)e[i]=o[i];return e}function t(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]}function n(){for(var e="$$",t=1;8>=t;t++){var n=Math.floor(16*Math.random()).toString(16);e+=n,(3==t||5==t)&&(e+="-")}return e}function r(e,t){for(var n={},r=0;r<e.length;r++)t.call(n,e[r],r)}function o(e,t){var n={};for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&t.call(n,e[r],r)}function i(e,t){return window.Object.prototype.toString.call(t)==="[object "+e+"]"}function a(e,t){if("object"!=typeof e)return e;t=t?t:i("Object",e)?{}:[];for(var n in e){var r=i("Object",e[n]),o=i("Array",e[n]),c=r||o;c?(t[n]=r?{}:[],a(e[n],t[n])):t[n]=e[n]}return t}function c(e,t){this._diffFlag=!0;for(var n in t){var r=i("Object",t[n])||i("Array",t[n]);if(!this._diffFlag)return!1;if(r&&e)c.call(this,e[n],t[n]);else{if(!e){this._diffFlag=!1;break}if(e[n]!=t[n]){this._diffFlag=!1;break}}}return this._diffFlag}function l(e){function t(t){return n?e==t:r?c.call({},t,e)&&c.call({},e,t):void 0}var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e||"undefined"==typeof e,r="function"!=typeof e;return{toEqual:t}}var s=(Object.prototype.toString,{inherit:e,compile:t,guid:n,loop:r,each:o,clone:a,expect:l,isArray:function(e){return i("Array",e)},isObject:function(e){return i("Object",e)},isFunction:function(e){return i("Function",e)},isString:function(e){return i("String",e)},isNumber:function(e){return i("Number",e)}});return s}),define("river.grammer.jbind",function(){function e(e,t,n,r){function o(n){n!==i&&(r?r[e]=n:t[e]=n,i=n,t.apply())}e=e.replace(/.+\./,"");var i=n.value=r&&r[e]||t[e]||"";this.eom[e]=this.eom[e]||[],this.eom[e].push({element:n,expression:"{{"+e+"}}"});var a;n.onfocus=function(){var e=this;a=setInterval(function(){o(e.value)},30)},n.onblur=function(){clearInterval(a)}}return e}),define("river.grammer.jChange",function(){function e(e){var t=this.scope[e],n=this.scope;this.node.onchange=function(){t.call({},this.value),n.apply()}}return e}),define("river.grammer.jclick",function(){function e(e,t,n,r){var o=e.replace(/\(.*\)/,""),i=t[o],a=/\((.*)\)/,c=e.match(a),l=[];c&&c.length&&(l=c[1].split(","));for(var s=[],u=0,p=l;p>u;u++){var f=t[l[u]]?t[l[u]]:l[u];s.push(f)}r&&(s=[r]);this.eom;n.onclick=function(){i.apply(n,s),t.apply()}}return e}),define("river.grammer.jcompile",function(){return function(){{var e=this.node,t=(this.scope,this.reg);e.textContent.replace(t,"")}}}),define("river.grammer.jon",function(){function e(e,t,n,r){var o=e.replace(/\(.*\)/,""),i=o.replace(/\s*[\||:].*/,""),a=o.replace(/.*[\||:]\s*/,""),c=t[a],l=/\((.*)\)/,s=e.match(l),u=[];s&&s.length&&(u=s[1].split(","));var p=(this.eom,"on"+i);n[p]=function(e){for(var o=[],i=0,a=u.length;a>i;i++){var l=t[u[i]]?t[u[i]]:"";o.push(l)}r&&(o=[r]),c.apply(n,[e].concat(o)),t.apply()}}return e}),define("river.grammer.repeat",function(e,t){function n(e){return s.need("river.grammer."+e)}function r(e){var t=/.*in\s/,n=/\sin.*/,r=/.*\./,l=e.replace(t,"").replace(r,""),s=this.scope[l],u=e.replace(n,""),p=this.node.parentNode,f=p.removeChild(this.node),d=document.createDocumentFragment(),v=this.reg,h=this.eom[l]=[];c=this.scope,f.removeAttribute("repeat"),i=f,a=p,h.repeatNode=f,h.repeatContainer=p,h.trans=o,h.key=u,h.reg=v,s&&s.length&&(s.forEach(function(e){var t=f.cloneNode(!0),n={};o(v,t,e,u,n),n.repeat=t,h.push(n),d.appendChild(t)}),p.appendChild(d))}function o(e,t,i,a,s){var p=!1;if(t.attributes&&t.attributes.length&&Array.prototype.forEach.call(t.attributes,function(o){if(e.test(o.nodeValue)){var f=o.nodeValue.replace(e,"").replace(a+".","");s[f]||(s[f]=[]),s[f].push({element:o,expression:o.nodeValue}),o.nodeValue=o.nodeValue.replace(/{{.*}}/,i[f])}if(u.node=t,u.scope=i,u.reg=e,u.eom=s,"repeat"===o.nodeName)p=!0,r.call(u,o.nodeValue.replace(e,""));else{var d=n(o.nodeName);if(l.isFunction(d)){var v=o.nodeValue.replace(e,"");u.eom={},d.call(u,v,c,u.node,u.scope)}}}),e.test(t.nodeValue)){var f=t.nodeValue.replace(e,"").replace(a+".","");s[f]||(s[f]=[]),s[f].push({element:t,expression:t.nodeValue});var d=l.isObject(i)?i[f]:i;t.nodeValue=t.nodeValue.replace(/{{.*}}/,d)}t.childNodes&&t.childNodes.length&&!p&&Array.prototype.forEach.call(t.childNodes,function(t){o(e,t,i,a,s)})}var i,a,c,l=t("river.core.tools"),s=(t("river.engine").scan,t("river.core.model"),this),u={};return r}),define("river.grammer.scope",function(){function e(e){this.node.removeAttribute("scope");var o=t.need(e);if(r.isObject(o)){var i=new n;for(var a in i)o[a]=i[a];o.__last__=r.clone(o),o.__eom__=this.eom,this.scope=o}else if(r.isFunction(o)){var c=new n;this.scope=c,o.call(c),c.__last__=r.clone(c),c.__eom__=this.eom}else{var l=(r.guid(),new n);l.__last__=r.clone(l),l.__eom__=this.eom,this.scope=l}}var t=this,n=t.need("river.core.model"),r=t.need("river.core.tools");return e});
//# sourceMappingURL=river.map
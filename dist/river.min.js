var _$river={sandbox:function(){var e={};return{create:function(n,t){n=n.toLowerCase(),e[n]=t},run:function(n){var t={need:function(n){return n=n.toLowerCase(),e[n]&&e[n].call(t)||void 0}};n.call(t)}}}};_$river.module=_$river.sandbox();var define=_$river.module.create,main=_$river.module.run;define("river.engine",function(){function e(e){return i.need("river.grammer."+e)}function n(n,o){var r={hasRepeat:!1,context:void 0};o&&(r.context=o);var i={scope:{},node:n,eom:{},reg:a};return n.attributes&&n.attributes.length&&c.loop(n.attributes,function(u){var s=u.nodeName,l=u.nodeValue.replace(a,""),p=e(s);"repeat"===s&&(r.hasRepeat=!0),"scope"===s?(r.context=i,o&&(r.context.scope=c.inherit(r.context.scope,o.scope),r.context.eom=c.inherit(r.context.eom,o.eom)),p.call(r.context,l)):c.isFunction(p)&&(r.context?(r.context.node=n,p.call(r.context,l),t(u,r.context)):(r.context=i,e("scope").call(r.context,l),p.call(r.context,l)))}),r}function t(e,n){if(a.test(e.nodeValue)){var t=e.nodeValue.replace(a,"");n.eom[t]||(n.eom[t]=[]),n.eom[t].push({element:e,expression:e.nodeValue}),e.nodeValue=e.nodeValue.replace(/{{.*}}/,n.scope[t])}}function o(e,n){e.childNodes&&e.childNodes.length&&c.loop(e.childNodes,function(e){r(e,n)})}function r(e,r){var i=n(e,r);i.context&&t(e,i.context),"CODE"===e.nodeName||"PRE"===e.nodeName||i.hasRepeat||(i.context?o(e,i.context):o(e))}var i=this,c=i.need("river.core.tools"),a=/.*{{\s*|\s*}}.*/g;return{scan:r}}),main(function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var n=e.need("river.engine").scan;n(document)})}),define("river.core.Date",function(){function e(e){var n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var t in n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e}var n=function(n){var t=new Date,o=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()+parseInt(n),t.getUTCMinutes(),t.getUTCSeconds());return{date:o,toString:function(n){return o.toString=e,o.toString(n)}}};return{getDateByCity:n}}),define("river.core.model",function(){function e(n,t,o){a(n)||u(n)?l(o[t],function(e){e.element.nodeValue=e.expression.replace(/{{.*}}/,n)}):i(n)?l(n,function(n,r){e(n,r,o[t][r])}):c(n)&&s(n,function(n,t){e(n,t,o)})}function n(e,n,t){o[e]=n,r[e]={},this.$$ns=e;for(var i in t)this[i]=t[i],last[i]=t[i]}var t=this.need("river.core.tools"),o={},r={},i=t.isArray,c=t.isObject,a=t.isString,u=t.isNumber,s=t.each,l=t.loop;return n.prototype.apply=function(){var n=o[this.$$ns],t=r[this.$$ns];s(this,function(o,r){n[r]&&t[r]!==o&&(e(o,r,n),t[r]=o)})},n.prototype.watch=function(){},n.prototype.inject=function(e){var n=this;s(e,function(t,o){n[o]=e[o]})},n}),define("river.core.tools",function(){var e=Object.prototype.toString,n={inherit:function(e,n){var t=function(){for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)?this[n]=e[n]:t.prototype[n]=e[n]};for(var o in n)t.prototype[o]=n[o];return new t},compile:function(e){var n=document.createElement("div");return n.innerHTML=e,n.childNodes[0]},guid:function(){for(var e="$$",n=1;8>=n;n++){var t=Math.floor(16*Math.random()).toString(16);e+=t,(3==n||5==n)&&(e+="-")}return e},loop:function(e,n){for(var t={},o=0;o<e.length;o++)n.call(t,e[o],o)},each:function(e,n){var t={};for(var o in e)e.hasOwnProperty&&e.hasOwnProperty(o)&&n.call(t,e[o],o)},log:function(){console&&Function.apply.call(console.log,console,arguments)},isArray:function(n){return"[object Array]"===e.apply(n)},isObject:function(e){return null!==e&&"object"==typeof e},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e}};return n}),define("river.grammer.jbind",function(){function e(e){function n(n){n!==r&&(o[e]=n,r=n,o.apply())}var t,o=this.scope,r=this.node.value=o[e];this.node.onfocus=function(){var e=this;t=setInterval(function(){n(e.value)},30)},this.node.onblur=function(){clearInterval(t)}}return e}),define("river.grammer.jChange",function(){function e(e){var n=this.scope[e],t=this.scope;this.node.onchange=function(){n.call({},this.value),t.apply()}}return e}),define("river.grammer.jclick",function(){function e(e){var n=e.replace(/\(.*\)/,""),t=this.scope[n],o=this.scope,r=/\((.*)\)/,i=e.match(r),c=[];i&&i.length&&(c=i[1].split(",")),this.node.onclick=function(){t.apply({},c),o.apply()}}return e}),define("river.grammer.jcompile",function(){return function(){}}),define("river.grammer.repeat",function(){function e(e){var t=/.*in\s/,o=/\sin.*/,r=/.*\./,i=e.replace(t,"").replace(r,""),c=this.scope[i],a=e.replace(o,""),u=this.node.parentNode,s=u.removeChild(this.node),l=document.createDocumentFragment(),p=this.reg,d=this.eom[i]=[];s.removeAttribute("repeat"),c&&c.length&&(c.forEach(function(e){var t=s.cloneNode(!0),o={};n(p,t,e,a,o),d.push(o),l.appendChild(t)}),u.appendChild(l))}function n(o,r,i,c,a){var u=!1;if(r.attributes&&r.attributes.length&&Array.prototype.forEach.call(r.attributes,function(n){if(o.test(n.nodeValue)){var s=n.nodeValue.replace(o,"").replace(c+".","");a[s]||(a[s]=[]),a[s].push({element:n,expression:n.nodeValue}),n.nodeValue=n.nodeValue.replace(/{{.*}}/,i[s])}"repeat"===n.nodeName&&(u=!0,t.node=r,t.scope=i,t.reg=o,t.eom=a,e.call(t,n.nodeValue.replace(o,"")))}),o.test(r.nodeValue)){var s=r.nodeValue.replace(o,"").replace(c+".","");a[s]||(a[s]=[]),a[s].push({element:r,expression:r.nodeValue}),r.nodeValue=r.nodeValue.replace(/{{.*}}/,i[s])}r.childNodes&&r.childNodes.length&&!u&&Array.prototype.forEach.call(r.childNodes,function(e){n(o,e,i,c,a)})}var t={};return e}),define("river.grammer.scope",function(){function e(e){var r=n.need(e);if(o.isObject(r))this.scope=r;else if(o.isFunction(r)){var i=new t(e,this.eom);this.scope=i,r.call(i)}else{var c=o.guid();this.scope=new t(c,this.eom)}}var n=this,t=n.need("river.core.model"),o=n.need("river.core.tools");return e});
//# sourceMappingURL=river.map
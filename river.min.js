var _$river={sandbox:function(){var e={};return{create:function(t,n){t=t.toLowerCase(),e[t]=n},run:function(t){var n={need:function(t){return t=t.toLowerCase(),e[t]&&e[t].call(n)||void 0}};t.call(n)}}}};_$river.module=_$river.sandbox();var define=_$river.module.create,main=_$river.module.run;define("river.engine",function(){function e(e){return i.need("river.grammer."+e)}function t(t,r){var o={hasRepeat:!1,context:r},i={scope:{},node:t,eom:{},reg:a};return t.attributes&&t.attributes.length&&c.loop(t.attributes,function(u){var s=u.nodeName,l=u.nodeValue.replace(a,""),f=e(s);"repeat"===s&&(o.hasRepeat=!0),"scope"===s?(o.context=i,f.call(o.context,l),r&&c.inherit(o.context.scope,r.scope)):c.isFunction(f)&&(o.context?(o.context.node=t,f.call(o.context,l),n(u,o.context)):(o.context=i,e("scope").call(o.context,l),f.call(o.context,l)))}),o}function n(e,t){if(a.test(e.nodeValue)){var n=e.nodeValue.replace(/\r|\n/g,"").replace(a,"");t.eom[n]||(t.eom[n]=[]),t.eom[n].push({element:e,expression:e.nodeValue}),e.nodeValue=e.nodeValue.replace(/\r|\n/g,"").replace(/{{.*}}/,t.scope[n])}}function r(e,t){e.childNodes&&e.childNodes.length&&c.loop(e.childNodes,function(e){o(e,t)})}function o(e,o){var i=t(e,o);i.context&&n(e,i.context),"CODE"===e.nodeName||"PRE"===e.nodeName||i.hasRepeat||(i.context?r(e,i.context):r(e))}var i=this,c=i.need("river.core.tools"),a=/.*{{\s*|\s*}}.*/g;return{scan:o}}),main(function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var t=e.need("river.engine").scan;t(document)})}),define("river.scenario",function(){function e(e,t){var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}this.need("river.core.tools");return{trigger:e}}),define("river.core.Date",function(){function e(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}var t=function(t){var n=new Date,r=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours()+parseInt(t),n.getUTCMinutes(),n.getUTCSeconds());return{date:r,toString:function(t){return r.toString=e,r.toString(t)}}};return{getDateByCity:t}}),define("river.core.model",function(){function e(t,n,r){a(t)||u(t)?l(r[n],function(e){e.element.nodeValue=e.expression.replace(/{{.*}}/,t)}):i(t)?l(t,function(t,o){e(t,o,r[n][o])}):c(t)&&s(t,function(t,n){e(t,n,r)})}function t(e,t,i){r[e]=t,o[e]={},this.$$ns=e;for(var c in i)this[c]=i[c],o[e]=n.clone(i)}var n=this.need("river.core.tools"),r={},o={},i=n.isArray,c=n.isObject,a=n.isString,u=n.isNumber,s=n.each,l=n.loop;return t.prototype.apply=function(){var t=r[this.$$ns],i=o[this.$$ns];s(this,function(r,o){t[o]&&!n.diff(i[o],r)&&(e(r,o,t),i[o]=r)})},t.prototype.watch=function(){},t.prototype.inject=function(e){var t=this;s(e,function(n,r){t[r]=e[r]})},t}),define("river.core.tools",function(){function e(e,t){var n=function(){for(var t in e)e.hasOwnProperty&&e.hasOwnProperty(t)?this[t]=e[t]:n.prototype[t]=e[t]};for(var r in t)n.prototype[r]=t[r];var o=new n;for(var i in o)e[i]=o[i];return e}function t(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]}function n(){for(var e="$$",t=1;8>=t;t++){var n=Math.floor(16*Math.random()).toString(16);e+=n,(3==t||5==t)&&(e+="-")}return e}function r(e,t){for(var n={},r=0;r<e.length;r++)t.call(n,e[r],r)}function o(e,t){var n={};for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&t.call(n,e[r],r)}function i(e,t){return window.Object.prototype.toString.call(t)==="[object "+e+"]"}function c(e,t){for(var n in t){var r=i("Object",t[n]),o=i("Array",t[n]),a=r||o;a?(e[n]=r?{}:[],c(e[n],t[n])):e[n]=t[n]}return e}function a(e,t){if("object"==typeof t){for(var n in t){var r="object"==typeof t[n];if(r)a(e,t);else if(e[n]!=t[n])return!1}return!0}return e==t}var u=(Object.prototype.toString,{inherit:e,compile:t,guid:n,loop:r,each:o,clone:c,diff:a,isArray:function(e){return i("Array",e)},isObject:function(e){return i("Object",e)},isFunction:function(e){return i("Function",e)},isString:function(e){return i("String",e)},isNumber:function(e){return i("Number",e)}});return u}),define("river.grammer.jbind",function(){function e(e){function t(t){t!==o&&(r[e]=t,o=t,r.apply())}var n,r=this.scope,o=this.node.value=r[e];this.node.onfocus=function(){var e=this;n=setInterval(function(){t(e.value)},30)},this.node.onblur=function(){clearInterval(n)}}return e}),define("river.grammer.jChange",function(){function e(e){var t=this.scope[e],n=this.scope;this.node.onchange=function(){t.call({},this.value),n.apply()}}return e}),define("river.grammer.jclick",function(){function e(e){var t=e.replace(/\(.*\)/,""),n=this.scope[t],r=this.scope,o=/\((.*)\)/,i=e.match(o),c=[];i&&i.length&&(c=i[1].split(",")),this.node.onclick=function(){n.apply({},c),r.apply()}}return e}),define("river.grammer.jcompile",function(){return function(){{var e=this.node,t=(this.scope,this.reg);e.textContent.replace(t,"")}}}),define("river.grammer.repeat",function(){function e(e){var n=/.*in\s/,r=/\sin.*/,o=/.*\./,i=e.replace(n,"").replace(o,""),c=this.scope[i],a=e.replace(r,""),u=this.node.parentNode,s=u.removeChild(this.node),l=document.createDocumentFragment(),f=this.reg,d=this.eom[i]=[];s.removeAttribute("repeat"),c&&c.length&&(c.forEach(function(e){var n=s.cloneNode(!0),r={};t(f,n,e,a,r),d.push(r),l.appendChild(n)}),u.appendChild(l))}function t(o,i,c,a,u){var s=!1;if(i.attributes&&i.attributes.length&&Array.prototype.forEach.call(i.attributes,function(t){if(o.test(t.nodeValue)){var n=t.nodeValue.replace(o,"").replace(a+".","");u[n]||(u[n]=[]),u[n].push({element:t,expression:t.nodeValue}),t.nodeValue=t.nodeValue.replace(/{{.*}}/,c[n])}"repeat"===t.nodeName&&(s=!0,r.node=i,r.scope=c,r.reg=o,r.eom=u,e.call(r,t.nodeValue.replace(o,"")))}),o.test(i.nodeValue)){var l=i.nodeValue.replace(o,"").replace(a+".","");u[l]||(u[l]=[]),u[l].push({element:i,expression:i.nodeValue});var f=n.isObject(c)?c[l]:c;i.nodeValue=i.nodeValue.replace(/{{.*}}/,f)}i.childNodes&&i.childNodes.length&&!s&&Array.prototype.forEach.call(i.childNodes,function(e){t(o,e,c,a,u)})}var n=this.need("river.core.tools"),r={};return e}),define("river.grammer.scope",function(){function e(e){var o=t.need(e);if(r.isObject(o))this.scope=o;else if(r.isFunction(o)){var i=new n(e,this.eom);this.scope=i,o.call(i)}else{var c=r.guid();this.scope=new n(c,this.eom)}}var t=this,n=t.need("river.core.model"),r=t.need("river.core.tools");return e});
//# sourceMappingURL=river.map
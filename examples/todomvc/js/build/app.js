define("app",function(){!function(){"use strict"}(window)});define("model.local",function(e,n,t){var o="todos-riverjs";e.get=function(){return JSON.parse(localStorage.getItem(o)||"[]")};e.save=function(e){localStorage.setItem(o,JSON.stringify(e))}});define("util.route",function(e,n,t){var o={};function i(){var e=location.hash;if(o[e]&&typeof o[e]=="function")o[e]()}window.addEventListener("hashchange",function(){i()});e.nav=function(){i()};e.when=function(e,n){o[e]=n;return this}});define("river.grammer.footer",function(e,n,t){var o=n("util.route"),i="selected";e=t.exports=a;function a(e,n,t){o.when("#/",function(){var e=t.querySelectorAll("#filters a");r(e);e[0].className=i}).when("#/active",function(){var e=t.querySelectorAll("#filters a");r(e);e[1].className=i}).when("#/completed",function(){var e=t.querySelectorAll("#filters a");r(e);e[2].className=i});o.nav()}function r(e){for(var n=0,t=e.length;n<t;n++){e[n].className=""}}});define("river.grammer.todo",function(e,n,t){var o=n("util.route"),i=n("controller.todos");e=t.exports=a;function a(e,n,t){var i=t.querySelector("[type=checkbox]");var a=t.querySelector(".edit");var f=t.querySelector("label");o.when("#/",function(){t.style.display="block"}).when("#/active",function(){var e=r(n);if(e=="active"){t.style.display="block"}else if(e=="completed"){t.style.display="none"}}).when("#/completed",function(){var e=r(n);if(e=="active"){t.style.display="none"}else if(e=="completed"){t.style.display="block"}});o.nav();n.onchange("status",function(e,n){o.nav()});f.ondblclick=function(){c(t)};a.addEventListener("blur",function(){l(t,n)});a.onkeydown=function(e){var o=e.keyCode===13||false;var i=e.keyCode===27||false;if(o||i){l(t,n)}}}function r(e){return e.todo.status}function c(e){var n=e.className;e.className=n+" editing";e.querySelector(".edit").focus()}function l(e,n){var t=e.className;e.className=t.replace(/\sediting/,"");i.save(n.todos)}});define("controller.todos",function(exports,require,module){var model=require("model.local"),todos=exports.todos=model.get();exports.newtodo="";function calStatus(){exports.activenum=0;exports.completednum=0;for(var i=0,len=todos.length;i<len;i++){if(todos[i].status=="active"){exports.activenum++}else{exports.completednum++}}}function save(todos){calStatus();model.save(todos)}exports.save=save;calStatus();exports.add=function(event){if(event.keyCode==13&&exports.newtodo){todos.unshift({desc:exports.newtodo,status:"active"});exports.newtodo="";save(todos)}};exports.remove=function(todo){var index=todos.indexOf(todo);todos.splice(index,1);save(todos)};exports.toggleall=function(){todos.forEach(function(d,i){if(exports.completednum>=0&&exports.completednum<todos.length){d.status="completed"}else{d.status="active"}});save(todos)};exports.toggleStatus=function(todo){if(todo.status=="active"){todo.status="completed"}else{todo.status="active"}save(todos)};exports.removeCompleted=function(){exports.completednum=0;todos=exports.todos=todos.filter(function(d,i){if(d.status!="completed"){return true}});save(todos)}});//# sourceMappingURL=app.map